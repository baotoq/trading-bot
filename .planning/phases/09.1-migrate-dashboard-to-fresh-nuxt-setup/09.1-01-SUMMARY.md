---
phase: 09.1-migrate-dashboard-to-fresh-nuxt-setup
plan: 01
subsystem: web-dashboard
tags: [nuxt4, migration, aspire, infrastructure]
dependency_graph:
  requires: [09-01, 09-02, 09.1-research]
  provides: [functional-nuxt4-dashboard, migrated-server-routes, aspire-integration]
  affects: [TradingBot.Dashboard, TradingBot.AppHost]
tech_stack:
  added: [@nuxt/ui-v4, tailwind-v4]
  patterns: [nuxt4-app-structure, css-imports, server-api-routes]
key_files:
  created:
    - TradingBot.Dashboard/app/assets/css/main.css
    - TradingBot.Dashboard/server/api/health.get.ts
    - TradingBot.Dashboard/server/api/portfolio.get.ts
    - TradingBot.Dashboard/server/utils/auth.ts
  modified:
    - TradingBot.Dashboard/nuxt.config.ts
    - TradingBot.Dashboard/app/app.vue
    - TradingBot.Dashboard/package.json
    - TradingBot.AppHost/AppHost.cs
  deleted:
    - dashboard/* (entire old directory)
decisions:
  - context: "compatibilityDate in nuxt.config.ts"
    decision: "Keep 2025-07-15 (Nuxt 4), not 2024-11-01 (old Nuxt 3)"
    rationale: "Nuxt 4 requires newer compatibility date for framework features"
  - context: "CSS location"
    decision: "Place at app/assets/css/main.css (inside app/ directory)"
    rationale: "Nuxt 4 uses app/ directory structure, ~ alias resolves to app/"
  - context: "@nuxt/ui version"
    decision: "Install v4 (not v3)"
    rationale: "v3 is incompatible with Nuxt 4 per research findings"
metrics:
  duration_minutes: 3
  tasks_completed: 2
  files_modified: 8
  files_created: 4
  files_deleted: 11
  commits: 2
  completed_at: 2026-02-13
---

# Phase 09.1 Plan 01: Migrate Dashboard to Fresh Nuxt Setup Summary

**One-liner:** Migrated Phase 9 dashboard features from old Nuxt 3 `dashboard/` to fresh Nuxt 4 `TradingBot.Dashboard/` with @nuxt/ui v4, Tailwind v4, server routes, and updated Aspire orchestration.

## Objective

Migrate all Phase 9 dashboard code from old `dashboard/` directory to fresh Nuxt 4 `TradingBot.Dashboard/` project, install missing dependencies, update AppHost path, and remove old directory. This ensures the dashboard uses Nuxt 4 with correct project references structure while maintaining all functional features (proxy, auth, health endpoint, Nuxt UI).

## What Was Built

### Task 1: Install Dependencies and Migrate Dashboard Source Files
**Commit:** 4214ff6

Installed @nuxt/ui v4 and TypeScript, then migrated all dashboard source files to TradingBot.Dashboard:

1. **Dependencies installed:**
   - @nuxt/ui v4.0.0+ (Nuxt 4 compatible, bundles Tailwind v4)
   - typescript v5.6.0+ (dev dependency)

2. **Configuration migrated:**
   - Updated `nuxt.config.ts` with:
     - `modules: ['@nuxt/ui']`
     - `css: ['~/assets/css/main.css']` (~ resolves to app/ in Nuxt 4)
     - `runtimeConfig` with server-side `apiKey` and public `apiEndpoint`
     - `routeRules` for `/proxy/api/**` proxy to backend
     - `compatibilityDate: '2025-07-15'` (Nuxt 4 date, not old Nuxt 3 date)
     - TypeScript strict mode enabled

3. **App component migrated:**
   - Replaced `app/app.vue` with UApp wrapper and BTC Smart DCA Dashboard content
   - Uses Nuxt UI dark mode classes

4. **CSS structure created:**
   - Created `app/assets/css/main.css` (inside app/ directory per Nuxt 4 structure)
   - Imports Tailwind v4 and Nuxt UI via CSS imports (no separate modules)

5. **Server routes migrated:**
   - Copied `server/api/health.get.ts` (health check for Aspire monitoring)
   - Copied `server/api/portfolio.get.ts` (proxy endpoint with server-to-server auth)
   - Copied `server/utils/auth.ts` (requireApiKey utility for auth validation)
   - Server files require ZERO modifications between Nuxt 3 and 4

**Verification:**
- `npx nuxi prepare` completed successfully
- All package dependencies installed
- nuxt.config.ts has all required settings
- app.vue has UApp wrapper
- CSS file exists with correct imports
- All server files migrated with requireApiKey function

### Task 2: Update Aspire AppHost Path and Remove Old Dashboard Directory
**Commit:** a68b333

Updated Aspire orchestration to reference new dashboard location and removed obsolete directory:

1. **AppHost.cs updated:**
   - Changed `AddNodeApp` path from `"../dashboard"` to `"../TradingBot.Dashboard"`
   - All other configuration unchanged (port 3000, env vars, WaitFor dependencies)

2. **Build verification:**
   - Ran `dotnet build TradingBot.AppHost` successfully
   - Build completed with 0 errors (only expected NuGet version warnings)

3. **Old directory removed:**
   - Deleted entire `dashboard/` directory (11 files)
   - Removed .gitignore, app/, assets/, server/, nuxt.config.ts, package files, tsconfig.json

**Verification:**
- AppHost.cs references `../TradingBot.Dashboard`
- Old path `"../dashboard"` removed
- dotnet build succeeds
- Old dashboard/ directory confirmed deleted

## Deviations from Plan

None - plan executed exactly as written.

## Technical Outcomes

**Migration Results:**
- ✅ TradingBot.Dashboard is fully functional Nuxt 4 project
- ✅ All Phase 9 features migrated: @nuxt/ui module, Tailwind v4 CSS imports, runtimeConfig, routeRules proxy, health/portfolio endpoints, requireApiKey utility
- ✅ Aspire orchestration points to new dashboard location
- ✅ Old dashboard/ directory removed
- ✅ Both `npx nuxi prepare` and `dotnet build TradingBot.AppHost` succeed

**Requirements Satisfied:**
- INFR-01: Dashboard integrated into Aspire orchestration (maintained with new path)
- INFR-02: Dashboard receives .NET API endpoint via environment variable (maintained)
- INFR-03: Health endpoint for Aspire monitoring (migrated)
- INFR-04: Dashboard starts after API service (maintained via WaitFor)

**Nuxt 4 Migration Success:**
- Correct app/ directory structure with assets inside
- Server routes at project root (not inside app/)
- @nuxt/ui v4 compatible with Nuxt 4
- CSS imports pattern (no @nuxtjs/tailwindcss module)
- compatibilityDate set to Nuxt 4 date (2025-07-15)
- tsconfig.json with project references preserved (not overwritten)

## Decisions Made

1. **compatibilityDate value:** Kept `2025-07-15` (Nuxt 4) instead of old `2024-11-01` (Nuxt 3). Nuxt 4 requires newer compatibility date for framework features.

2. **CSS location:** Placed at `app/assets/css/main.css` (inside app/ directory) because Nuxt 4 uses app/ directory structure and ~ alias resolves to app/.

3. **@nuxt/ui version:** Installed v4 (not v3) because v3 is incompatible with Nuxt 4 per research findings.

## Files Changed

**Created (4):**
- TradingBot.Dashboard/app/assets/css/main.css
- TradingBot.Dashboard/server/api/health.get.ts
- TradingBot.Dashboard/server/api/portfolio.get.ts
- TradingBot.Dashboard/server/utils/auth.ts

**Modified (4):**
- TradingBot.Dashboard/nuxt.config.ts
- TradingBot.Dashboard/app/app.vue
- TradingBot.Dashboard/package.json (+ package-lock.json)
- TradingBot.AppHost/AppHost.cs

**Deleted (11):**
- dashboard/.gitignore
- dashboard/app/app.vue
- dashboard/assets/css/main.css
- dashboard/nuxt.config.ts
- dashboard/package.json
- dashboard/package-lock.json
- dashboard/server/api/health.get.ts
- dashboard/server/api/portfolio.get.ts
- dashboard/server/utils/auth.ts
- dashboard/tsconfig.json
- (entire dashboard/ directory removed)

## Next Steps

Phase 09.1 Plan 02 (if exists) or proceed to Phase 10 per ROADMAP.md.

## Self-Check: PASSED

All created files verified:
- ✅ TradingBot.Dashboard/app/assets/css/main.css
- ✅ TradingBot.Dashboard/server/api/health.get.ts
- ✅ TradingBot.Dashboard/server/api/portfolio.get.ts
- ✅ TradingBot.Dashboard/server/utils/auth.ts

All commits verified:
- ✅ commit 4214ff6 (Task 1)
- ✅ commit a68b333 (Task 2)

---

**Plan Duration:** 3 minutes
**Tasks Completed:** 2/2
**Status:** ✅ Complete
